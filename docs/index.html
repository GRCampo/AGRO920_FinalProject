<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Models</title>
  <meta name="description" content="This report covers all classes from PLPTH 820 course." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Models" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This report covers all classes from PLPTH 820 course." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Models" />
  
  <meta name="twitter:description" content="This report covers all classes from PLPTH 820 course." />
  

<meta name="author" content="Gabriela Romero Campos" />


<meta name="date" content="2025-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  

<link rel="next" href="data-acquisition.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">AGRO 920</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#project-overview"><i class="fa fa-check"></i><b>1.2</b> Project Overview</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#objective"><i class="fa fa-check"></i><b>1.2.1</b> Objective</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#why-k-mers"><i class="fa fa-check"></i><b>1.2.2</b> Why k-mers?</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#why-pseudo-samples-ps"><i class="fa fa-check"></i><b>1.2.3</b> Why pseudo-samples (PS)?</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#why-machine-learning"><i class="fa fa-check"></i><b>1.2.4</b> Why machine learning?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-acquisition.html"><a href="data-acquisition.html"><i class="fa fa-check"></i><b>2</b> Data Acquisition</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-acquisition.html"><a href="data-acquisition.html#download"><i class="fa fa-check"></i><b>2.1</b> Download</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="quality-control.html"><a href="quality-control.html"><i class="fa fa-check"></i><b>3</b> Quality Control</a>
<ul>
<li class="chapter" data-level="3.1" data-path="quality-control.html"><a href="quality-control.html#fastqc-and-multiqc"><i class="fa fa-check"></i><b>3.1</b> FastQC and MultiQC</a></li>
<li class="chapter" data-level="3.2" data-path="quality-control.html"><a href="quality-control.html#duplicate-removal-with-markduplicates"><i class="fa fa-check"></i><b>3.2</b> Duplicate Removal with MarkDuplicates</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="pseudosamples-from-raw-reads.html"><a href="pseudosamples-from-raw-reads.html"><i class="fa fa-check"></i><b>4</b> Pseudosamples from Raw Reads</a>
<ul>
<li class="chapter" data-level="4.1" data-path="pseudosamples-from-raw-reads.html"><a href="pseudosamples-from-raw-reads.html#merge-paired-end-reads-into-a-single-fasta"><i class="fa fa-check"></i><b>4.1</b> Merge Paired-end Reads into a Single FASTA</a></li>
<li class="chapter" data-level="4.2" data-path="pseudosamples-from-raw-reads.html"><a href="pseudosamples-from-raw-reads.html#split-into-pseudosamples"><i class="fa fa-check"></i><b>4.2</b> Split into Pseudosamples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html"><i class="fa fa-check"></i><b>5</b> K-mer Extraction and Filtering</a>
<ul>
<li class="chapter" data-level="5.1" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#k-mer-counting-with-jellyfish"><i class="fa fa-check"></i><b>5.1</b> K-mer Counting with Jellyfish</a></li>
<li class="chapter" data-level="5.2" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#pseudosample-merging-by-treatment"><i class="fa fa-check"></i><b>5.2</b> Pseudosample Merging by Treatment</a></li>
<li class="chapter" data-level="5.3" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#global-merging-by-group"><i class="fa fa-check"></i><b>5.3</b> Global Merging by Group</a></li>
<li class="chapter" data-level="5.4" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#aggregation-and-total-count-per-k-mer"><i class="fa fa-check"></i><b>5.4</b> Aggregation and Total Count per K-mer</a></li>
<li class="chapter" data-level="5.5" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#filtering-kmers"><i class="fa fa-check"></i><b>5.5</b> Filtering kmers</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#step-1-abundance-threshold"><i class="fa fa-check"></i><b>5.5.1</b> Step 1: Abundance Threshold</a></li>
<li class="chapter" data-level="5.5.2" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#step-2-coefficient-of-variation-cv"><i class="fa fa-check"></i><b>5.5.2</b> Step 2: Coefficient of Variation (CV)</a></li>
<li class="chapter" data-level="5.5.3" data-path="k-mer-extraction-and-filtering.html"><a href="k-mer-extraction-and-filtering.html#step-3-redundancy-removal-with-cd-hit-est"><i class="fa fa-check"></i><b>5.5.3</b> Step 3: Redundancy Removal with CD-HIT-EST</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html"><i class="fa fa-check"></i><b>6</b> Exploratory Analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#total-counts"><i class="fa fa-check"></i><b>6.1</b> Total counts</a></li>
<li class="chapter" data-level="6.2" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#variance"><i class="fa fa-check"></i><b>6.2</b> Variance</a></li>
<li class="chapter" data-level="6.3" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#pca"><i class="fa fa-check"></i><b>6.3</b> PCA</a></li>
<li class="chapter" data-level="6.4" data-path="exploratory-analysis.html"><a href="exploratory-analysis.html#t-sne"><i class="fa fa-check"></i><b>6.4</b> t-SNE</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>7</b> Models</a>
<ul>
<li class="chapter" data-level="7.1" data-path="models.html"><a href="models.html#random-forest"><i class="fa fa-check"></i><b>7.1</b> Random Forest</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="models.html"><a href="models.html#confusion-matrices"><i class="fa fa-check"></i><b>7.1.1</b> Confusion Matrices</a></li>
<li class="chapter" data-level="7.1.2" data-path="models.html"><a href="models.html#performance-metrics-and-roc-curves"><i class="fa fa-check"></i><b>7.1.2</b> Performance Metrics and ROC Curves</a></li>
<li class="chapter" data-level="7.1.3" data-path="models.html"><a href="models.html#important-k-mers-associated-with-heat-stress-1h"><i class="fa fa-check"></i><b>7.1.3</b> Important k-mers associated with heat stress (1h)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Models</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="header">
<h1 class="title">Models</h1>
<p class="author"><em>Gabriela Romero Campos</em></p>
<p class="date"><em>2025-05-14</em></p>
</div>
<div id="about" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> About<a href="index.html#about" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This project was developed as part of the AGRO 920 – Predictive Modeling for Plant Breeding course at Kansas State University. The goal wasn’t to reinvent the wheel, but to show that I can work with complex biological data and apply machine learning models in a meaningful way. In short: build a working pipeline, survive the process, and (hopefully) get useful results.</p>
<p>The project combines plant genomics, transcriptomics, and predictive modeling to find patterns in RNA-seq data related to abiotic stress in wheat (<em>Triticum aestivum</em>). Instead of using a reference genome, I followed a reference free approach: breaking raw reads into k-mers and using them directly as input for machine learning models. It’s a bit unconventional, but sometimes going around the map is faster than sticking to the official roads.</p>
<p>All scripts, data processing steps, and model evaluations are clearly documented — partly for reproducibility, and partly so future-me doesn’t hate past-me when trying to understand what I did.</p>
<p>The raw data and intermediate files are stored in the <strong>AGRO920 folder of my Beocat user directory</strong>. If you’d like access, feel free to ask, I’ll gladly give permission. The <code>results</code> and <code>scripts</code> folders are also available on <a href="https://github.com/GRCampo/AGRO920_FinalProject.git">my GitHub</a> for anyone interested in the pipeline or plots without digging through a cluster.</p>
<div id="data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Data<a href="index.html#data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The dataset used in this project comes from <a href="https://doi.org/10.1186/s12870-015-0511-8">Liu et al. (2015)</a>, a study that investigated transcriptional responses of wheat under drought (DS), heat (HS), and combined heat and drought (HD) stress. The experiment used the TAM 107 cultivar, sampled at two time points (1h and 6h after stress onset), and focused on leaf tissue, where most of the drama tends to happen under stress. In total, 14 samples were sequenced, each with replicates, producing about 900 million 100-bp paired-end reads via the Illumina platform. A small and quiet dataset (~contains irony).</p>
<p>For this project, the raw RNA-seq reads were downloaded from the NCBI SRA and processed through a reference-free, k-mer-based pipeline that is equal parts practical and a little bit original. The steps:</p>
<ul>
<li>Quality checks were performed with <strong>FastQC</strong>, <strong>MultiQC</strong>, and <strong>MarkDuplicates</strong>.</li>
<li>Reads were converted to FASTA and split into pseudo-samples (<strong>100 files per sample</strong>) to simulate replicates and make downstream modeling less of a statistical nightmare.</li>
<li><strong>Jellyfish</strong> (v2.3.0) was used to count k-mers with a length of 41.</li>
<li>The resulting k-mer matrix was filtered by abundance (count &gt; 10), variability (top 25% CV), and redundancy (95% similarity via CD-HIT), leaving behind a lean set of 13,490 representative k-mers.</li>
</ul>
<p>Then, I used this k-mer matrix for:</p>
<ul>
<li><strong>Exploratory analysis</strong> with PCA and t-SNE, to see whether the pseudo-samples wanted to behave and cluster by treatment.</li>
<li>Supervised modeling using <strong>Random Forest</strong>, to classify stress conditions and exposure times — or at least try to.</li>
<li>Feature selection, to highlight the most informative k-mers.</li>
</ul>
</div>
<div id="project-overview" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Project Overview<a href="index.html#project-overview" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="objective" class="section level3 hasAnchor" number="1.2.1">
<h3><span class="header-section-number">1.2.1</span> Objective<a href="index.html#objective" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This project aims to identify k-mers associated with specific abiotic stress conditions and time points in wheat using a machine learning framework. The central hypothesis? That raw RNA-seq reads contain hidden sequence patterns. Patterns that can be detected at the k-mer level, which reflect how the plant is responding to heat, drought, or the lovely combination of both.</p>
<p>To test this, I built a reference-free pipeline that strings together preprocessing, pseudo-sample generation, k-mer extraction, dimensionality reduction, and supervised classification. The goal wasn’t just to classify samples correctly (though that’s nice), but to use the models to highlight the most informative k-mers — those little fragments of sequence that might actually tell us something biologically interesting.</p>
</div>
<div id="why-k-mers" class="section level3 hasAnchor" number="1.2.2">
<h3><span class="header-section-number">1.2.2</span> Why k-mers?<a href="index.html#why-k-mers" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Instead of relying on annotated genes or transcript quantification, this pipeline starts from scratch, literally from the raw reads. K-mer counting skips the need for a reference genome, which is great news if your species of interest doesn’t have one (or has one that’s… questionable). It also gives you the chance to capture signal from other places as non-coding RNAs, or whatever else the reference might have missed or ignored. It’s messy, but in a good way.</p>
</div>
<div id="why-pseudo-samples-ps" class="section level3 hasAnchor" number="1.2.3">
<h3><span class="header-section-number">1.2.3</span> Why pseudo-samples (PS)?<a href="index.html#why-pseudo-samples-ps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The original dataset has only two biological replicates per treatment, which is a great work but, let’s be honest, not ideal for training machine learning models. To work around this, I created pseudosamples (PS): smaller subsets of reads, randomly split from the originals while keeping the paired-end structure intact.</p>
<p>Are they true biological replicates? No. Do they help the model see more of the internal variation without cheating? Yes, if you split your training and testing sets carefully (which I did). <strong>It’s not perfect</strong>, but it’s better than pretending two replicates are enough.</p>
</div>
<div id="why-machine-learning" class="section level3 hasAnchor" number="1.2.4">
<h3><span class="header-section-number">1.2.4</span> Why machine learning?<a href="index.html#why-machine-learning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Because this project lives at the intersection of “too many variables” and “not enough samples,” and that’s exactly the kind of problem machine learning is designed for.</p>
<p>Classical tools like edgeR or DESeq2 are great when you want to find single DEGs that behave nicely. But ML models can look at thousands of features at once and pick up more subtle or multivariate signal, the kind you’d never spot with p-values alone. Here, the models are used not just to classify but to learn and prioritize which k-mers matter most, opening the door to future work in stress diagnostics and functional genomics.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>

<a href="data-acquisition.html" class="navigation navigation-next navigation-unique" aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
